(function(){"use strict";function t(){let t=prompt("Menu:\n\r1. Select month\n\r2. Upload file\n\r");switch(t){case"1":e();break;case"2":r();break;default:alert("Invalid selection. Please choose 1 or 2.")}}function e(){document.querySelectorAll("#calendar_container > tbody > tr > td:nth-child(-n+6).cDIES[ondblclick]").forEach(t=>t.click()),document.querySelector("#ctl00_mp_RefreshSelectedDays").click()}function r(){var t=document.createElement("input");t.type="file",t.accept=".xls,.xlsx,.html,.htm",t.onchange=(t=>{c=t.target.files[0],c?n():alert("No file selected.")}),t.click()}function n(){let t=new FileReader;t.onload=function(t){o=t.target.result,!o||o.length<100?alert("File appears empty or invalid."):l()},t.onerror=function(){alert("Error reading file.")},t.readAsText(c)}function l(){a=document.createElement("html");try{a.innerHTML=o,i()}catch(t){alert("Error parsing report file.")}}function i(){var t=a.querySelectorAll("body > div > table > tbody > tr:has(td)");if(t&&0!==t.length){var e=Array.prototype.slice.call(t).filter(t=>{try{return""===t.querySelector("td:nth-child(8)").innerText||"עבודה מהבית /מחוץ למשרד"===t.querySelector("td:nth-child(8)").innerText}catch(t){return!1}});if(0!==e.length){var r={};e.forEach(t=>{try{var e=t.querySelector("td:nth-child(1)").innerText.match(/\d+\/\d+(\/\d+)?/);if(!e)return;var n=e[0].substring(0,5),l=t.querySelector("td:nth-child(5)").innerText,i=t.querySelector("td:nth-child(6)").innerText,d=t.querySelector("td:nth-child(7)")?t.querySelector("td:nth-child(7)").innerText:"";r[n]||(r[n]={periods:[],durations:[]}),r[n].periods.push({start:l,end:i}),d&&r[n].durations.push(d)}catch(t){}}),h=[];for(const[t,{periods:e,durations:n}]of Object.entries(r)){const r=e.filter((t,e,r)=>{if("00:00"===t.start&&n.includes(t.end))return!1;if(n.includes(t.start)&&n.includes(t.end))return!1;for(let r=0;r<e;r++)if(t.start===n[r]){let e=0;for(let t=0;t<=r;t++){const r=n[t];if(r&&r.includes(":")){const[t,n]=r.split(":").map(Number);e+=60*t+n}}if(n[r+1]&&n[r+1].includes(":")){const[t,l]=n[r+1].split(":").map(Number);e+=60*t+l}const l=Math.floor(e/60),i=e%60,d=`${l.toString().padStart(2,"0")}:${i.toString().padStart(2,"0")}`;if(t.end===d)return!1}return!0});h.push({date:t,timePeriods:r})}0!==h.length?(console.dir(h),d()):alert("No valid time periods found after filtering.")}else alert("No working days found in report.")}else alert("No valid rows found in report.")}function d(){var t=Array.prototype.slice.call(document.querySelectorAll("form > div.rtl.h-master-outerpage.container-fluid > div:nth-child(6) > div > div.ml-0.mr.mt.row > div > div > div > div.rtl.alignright > div > table > tbody > tr:nth-child(2) > td > div.GBC.ltr.alignleft > div > table > tbody > tr"));t&&0!==t.length?t.forEach(t=>{var e=t.querySelector("td.regularItemCell.ItemBorder > span");if(e){var r=e.innerText.replace(/[^\d\/]+/,""),n=h.find(t=>t.date===r);if(n){var l=t.nextSibling;n.timePeriods.forEach((t,e)=>{try{e>0&&(setTimeout(function(){var t="DO NOT ERASE";t=t.substring(0,t.length),t+=""},100),l.querySelector("td.BBCG.ImageCell > span > input[type=image]").click()),l.querySelector("td:nth-child(2) > table > tbody > tr:nth-child("+(e+1)+") > td:nth-child(3) > table > tbody > tr:nth-child(1) + td:nth-child(3) > span").click(),l.querySelector("td:nth-child(2) > table > tbody > tr:nth-child("+(e+1)+") > td:nth-child(7) > input").value=t.start,l.querySelector("td:nth-child(2) > table > tbody > tr:nth-child("+(e+1)+") > td:nth-child(8) > input").value=t.end}catch(t){}})}}}):alert("No form rows found to fill.")}var c,o,a,h=[];t()})();